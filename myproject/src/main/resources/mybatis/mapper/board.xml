<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.study.board.IBoardDao">

	<sql id="search">
		<if test="@org.apache.commons.lang3.StringUtils@isNotBlank(searchCategory)">
			AND bo_cate = #{searchCategory}
		</if>
	</sql>
	
	<select id="getTotalRowCount" parameterType="com.study.board.BoardSerchVO" resultType="int">
		SELECT count(*)      
		FROM board      
		WHERE 1=1
		<include refid="search"></include>		
	</select>

	<select id="getBoardList" parameterType="com.study.board.BoardVO"
	resultType="com.study.board.BoardVO">
		<include refid="common.prePage"></include>         
		SELECT
		    bo_no		    , bo_title		    , bo_cate
		    , bo_mem_id    , bo_content	    , bo_hit
		    , TO_CHAR(bo_reg_date,'YYYY-MM-dd') AS bo_reg_date   
		    , TO_CHAR(bo_mod_date,'YYYY-MM-dd') AS bo_mod_date 
		FROM	board
		WHERE 1=1
		<include refid="search"></include>
		ORDER BY bo_no desc           
		<include refid="common.postPage"></include>
	</select>
	
	<select id="getBoard" parameterType="int" resultType="com.study.board.BoardVO" >
		SELECT
		    bo_no		    , bo_title		    , bo_cate
		    , bo_mem_id    , bo_content	    , bo_hit
		    , bo_reg_date  , bo_mod_date
		FROM  board
		WHERE bo_no=#{boNo} 
	</select>
	
		
	<select id="getmyBoard" parameterType="String" resultType="com.study.board.BoardVO">
	SELECT
    bo_no		       	, bo_title		    , bo_cate
    , bo_mem_id       , bo_content		    , bo_hit
    , bo_reg_date     , bo_mod_date
	FROM
	    board
	WHERE bo_mem_id = #{boMemId}
	</select>
	
	<update id="addHit" parameterType="int">
		UPDATE board SET
		bo_hit = bo_hit+1
		WHERE bo_no=#{boNo}	
	</update>
	
	<update id="updateBoard" parameterType="com.study.board.BoardVO">	
		UPDATE board SET
		bo_title = #{boTitle}
		,bo_cate = #{boCate}
		,bo_content = #{boContent}
		,bo_mod_date = sysdate		
		WHERE bo_no = #{boNo}					
	</update>
	
	<update id="deleteBoard" parameterType="int">
		DELETE FROM board
		WHERE    bo_no = #{boNo}	
	</update>
	
	<update id="insertBoard" parameterType="com.study.board.BoardVO">
		INSERT INTO board (
		    bo_no		    , bo_title		    , bo_cate
		    , bo_mem_id    , bo_content	    , bo_hit
		    , bo_reg_date  , bo_mod_date
		) VALUES (
		    board_seq.nextval    , #{boTitle}	    , #{boCate}	
		    , #{boMemId}    		, #{boContent}   , 0
		    , sysdate 	      		, null
		)
	</update>


</mapper>